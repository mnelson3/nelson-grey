project:
  name: vehicle-vitals
  description: "Vehicle management app with web and mobile clients"
  owner: nelsongrey

targets:
  ios:
    enabled: true
    schemes:
      - name: "Vehicle Vitals"
        path: "packages/mobile/ios"
        configuration: "Release"
    signing:
      team_id: "${APPLE_TEAM_ID}"
      bundle_id: "com.nelsongrey.vehiclevitals"
      profiles:
        development: true
        distribution: true
    destinations:
      testflight:
        enabled: true
        group: "Internal Testers"
      appstore:
        enabled: true

  android:
    enabled: true
    path: "packages/mobile/android"
    signing:
      keystore_ref: "${ANDROID_KEYSTORE_PATH}"
      key_alias: "${ANDROID_KEY_ALIAS}"
    destinations:
      firebase_app_distribution:
        enabled: true
        groups:
          - testers
      google_play:
        enabled: true
        track: "internal"

  web:
    enabled: true
    build_command: "cd packages/web && npm run build"
    destinations:
      firebase_hosting:
        enabled: true

  docker:
    enabled: false

  firebase:
    enabled: true
    project_id: "vehicle-vitals-prod"
    hosting:
      enabled: true
    functions:
      enabled: false
    firestore:
      deploy_rules: true
      deploy_indexes: true

ci:
  runners:
    macos:
      labels:
        - self-hosted
        - macOS
        - ios
      required: true
    docker:
      labels:
        - self-hosted
        - docker
      required: false

  triggers:
    - event: push
      branches:
        - develop
      paths:
        - "packages/mobile/**"
        - "packages/web/**"
        - ".github/workflows/**"

    - event: pull_request
      branches:
        - develop
        - staging
        - main

    - event: workflow_dispatch

  environment:
    development:
      firebase_config: "firebase.dev.json"
      secrets_profile: "dev"
    staging:
      firebase_config: "firebase.staging.json"
      secrets_profile: "staging"
    production:
      firebase_config: "firebase.prod.json"
      secrets_profile: "prod"

notifications:
  slack_webhook: "${SLACK_WEBHOOK_URL}"
  failure_recipients:
    - "mark@example.com"
