project:
  name: wishlist-wizard
  description: "Wishlist management platform with cross-platform support"
  owner: mnelson3

targets:
  ios:
    enabled: true
    schemes:
      - name: "Wishlist Wizard"
        path: "packages/mobile/ios"
        configuration: "Release"
    signing:
      team_id: "${APPLE_TEAM_ID}"
      bundle_id: "com.wishlist-wizard"
      profiles:
        development: true
        distribution: true
    destinations:
      testflight:
        enabled: true
        group: "Internal Testers"
      appstore:
        enabled: true

  android:
    enabled: true
    path: "packages/mobile/android"
    signing:
      keystore_ref: "${ANDROID_KEYSTORE_PATH}"
      key_alias: "${ANDROID_KEY_ALIAS}"
    destinations:
      firebase_app_distribution:
        enabled: true
        groups:
          - testers
      google_play:
        enabled: true
        track: "internal"

  web:
    enabled: true
    build_command: "npm run build"
    destinations:
      firebase_hosting:
        enabled: true

  docker:
    enabled: true
    services:
      - name: "api"
        dockerfile: "Dockerfile"
        registry: "docker.io"
        image_name: "wishlist-wizard-api"
      - name: "web"
        dockerfile: "web.Dockerfile"
        registry: "docker.io"
        image_name: "wishlist-wizard-web"

  firebase:
    enabled: true
    project_id: "wishlist-wizard-prod"
    hosting:
      enabled: true
    functions:
      enabled: true
      paths:
        - "packages/functions"
    firestore:
      deploy_rules: true
      deploy_indexes: true

ci:
  runners:
    macos:
      labels:
        - self-hosted
        - macOS
        - ios
      required: true
    docker:
      labels:
        - self-hosted
        - docker
      required: true

  triggers:
    - event: push
      branches:
        - develop
      paths:
        - "packages/mobile/**"
        - "packages/web/**"
        - "packages/functions/**"
        - ".github/workflows/**"

    - event: pull_request
      branches:
        - develop
        - staging
        - main

    - event: workflow_dispatch

  environment:
    development:
      firebase_config: "firebase.dev.json"
      secrets_profile: "dev"
    staging:
      firebase_config: "firebase.staging.json"
      secrets_profile: "staging"
    production:
      firebase_config: "firebase.prod.json"
      secrets_profile: "prod"

notifications:
  slack_webhook: "${SLACK_WEBHOOK_URL}"
  failure_recipients:
    - "mark@example.com"
